function updatePlaceholders(e){const t=document.querySelectorAll("input[placeholder]");t.forEach(t=>{const n=t.getAttribute(`data-${e}-placeholder`);n&&(t.placeholder=n)})}function updateTextContent(e){const t=document.querySelectorAll("[data-en]");t.forEach(t=>{const n=t.getAttribute(`data-${e}`);n&&(t.textContent=n)})}function setLanguage(e){updatePlaceholders(e),updateTextContent(e),localStorage.setItem("language",e),document.documentElement.lang=e;const t=document.querySelector("title");t&&t.getAttribute(`data-${e}`)&&(document.title=t.getAttribute(`data-${e}`))}function getCurrentLanguage(){return localStorage.getItem("language")||"en"}function showTranslatedAlert(e,...t){const n=getCurrentLanguage(),a=alertMessages[e]&&alertMessages[e][n]||e;alert(a+" "+t.join(" "))}document.addEventListener("DOMContentLoaded",async function(){const e=document.getElementById("changePasswordForm"),t=document.getElementById("newPassword"),n=document.getElementById("confirmPassword"),a=document.getElementById("passwordMismatch"),s="https://jvuibcqogyyffylvfeog.supabase.co",o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp2dWliY3FvZ3l5ZmZ5bHZmZW9nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzYzMjg3MzUsImV4cCI6MjA1MTkwNDczNX0.iIu6f3LwdLmHoHmuVjbuVm-uLCDWA3oGZ7J07wXGBBU",r=window.supabase.createClient(s,o),d=window.location.hash.substring(1),i=new URLSearchParams(d),l=i.get("access_token"),c=i.get("refresh_token"),u=i.get("type");if(!l||"recovery"!==u)return console.error("Invalid recovery link"),void window.translatedAlert("invalid_password_reset_link");try{const{data:e,error:t}=await r.auth.setSession({access_token:l,refresh_token:c});if(t)throw t;console.log("User authenticated:",e.user)}catch(e){return console.error("Error setting session:",e.message),void window.translatedAlert("reset_token_verification_error")}if(e){function g(){a.style.display="none"}e.addEventListener("submit",async function(e){e.preventDefault();const s=t.value,o=n.value;if(s===o){a.style.display="none";try{const{data:e,error:t}=await r.auth.updateUser({password:s});if(t)throw t;console.log("Password changed successfully"),window.translatedAlert("password_change_success"),window.location.href="index.html"}catch(e){console.error("Error changing password:",e.message),window.translatedAlert("password_reset_failed",e.message)}}else a.style.display="block"}),t.addEventListener("input",g),n.addEventListener("input",g)}r.auth.onAuthStateChange((e,t)=>{"PASSWORD_RECOVERY"===e&&console.log("PASSWORD_RECOVERY event detected",t)})}),document.addEventListener("DOMContentLoaded",()=>{const e=getCurrentLanguage();setLanguage(e)});const alertMessages={reset_token_verification_error:{en:"Error verifying reset token. Please request a new password reset.",fr:"Erreur de vérification du jeton de réinitialisation. Veuillez demander une nouvelle réinitialisation de mot de passe."},invalid_password_reset_link:{en:"Invalid password reset link. Please request a new password reset.",fr:"Lien de réinitialisation de mot de passe invalide. Veuillez demander une nouvelle réinitialisation de mot de passe."},password_change_success:{en:"Password changed successfully",fr:"Mot de passe changé avec succès"},password_reset_failed:{en:"Password reset failed:",fr:"Échec de la réinitialisation du mot de passe :"}};window.translatedAlert=showTranslatedAlert,document.addEventListener("DOMContentLoaded",()=>{localStorage.getItem("language")||localStorage.setItem("language","en")});